---
title: "JK"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(tidyverse)
library(lubridate)
library(openintro)
```

```{r}
### CLEANING MEDIA DATA
#Read the media data
media <- read.csv("suicid-or-suicid-and-sampled-stories-20181213194457.csv")
media2 <- read.csv("suicid-or-suicid-and-stories-over-time-20181213191601.csv")

#Extract the year information from the publication date
media <- media %>% mutate(date = ymd_hms(publish_date))
media <- media %>% separate(date, c("date", "hour_min"), " ")
media <- media %>% mutate(year = year(date), month = month(date), day = day(date))
media <- media %>% filter(language == "en")

#Separate the publication state (state, year) into 2 separate variables: state and country
media <- media %>% separate(media_pub_state, c("state", "country"), ",")

#Create a variable with state abbreviations from the state name
media <- media %>% mutate(state_abb = ifelse(nchar(state)>2, state.abb[match(state, state.name)], state))

#Find titles that include the term 'suicid' and create a new variable "suicide_title"" that returns 1 if "suicid" is present, else 0
media <- media %>% mutate(suicide_title = ifelse(str_detect(title, "suicid"), 1, 0))
```

```{r}
###COUNT AND RATIO PLOTS
#Count plot
p1 <- media2 %>% 
  ggplot(aes(date, count, group = 1)) + 
  geom_line(colour = "darkorchid4") + 
  scale_x_discrete(breaks = c("2011-01-01", "2012-01-01", "2013-01-01", "2014-01-01", "2015-01-01", "2016-01-01", "2017-01-01", "2018-01-01"), labels = c("2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018")) + 
  xlab("Year") + ylab("Count")

print(p1)

#Ratio plot
p2 <- media2 %>% 
  ggplot(aes(date, ratio, group = 1)) + 
  geom_line(colour = "darkorchid4") + 
  scale_x_discrete(breaks = c("2011-01-01", "2012-01-01", "2013-01-01", "2014-01-01", "2015-01-01", "2016-01-01", "2017-01-01", "2018-01-01"), labels = c("2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018")) + 
  xlab("Year") + ylab("Ratio")

print(p2)
```

